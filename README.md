# Электронный каталог для библиотеки на c++ builder
Электронный каталог для библиотеки на c++ builder
Задание
1. Условие задачи
    ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/cc403051-9034-40ef-b5a6-1700d9f3ae63)
2.Постановка задачи
   Реализовать программу “Электронный каталог для библиотеки”, используя среду разработки C++ Builder согласно условию задачи варианта 1.3.
3.	Решение задачи
   Программа хранит данные в БД Microsoft Access. Подключение бд через C++ Builder осуществляется через следующие компоненты: ADOConnection (указывает путь к бд на локальной машине, используя драйвер Jet.OLEDB.4), ADOTable (устанавливает связь с конкретной таблицей по ее названию), DBGrid (таблица, в которую заносятся все данные из таблицы, с которой установлена связь; при изменении данных в DBGrid данные изменяются в таблице в Access), DataSource (устанавливается связь между компонентами ADOTable и  DBGrid), DBNavigator (выполняет следующие операции с таблицей DBGrid: перемещение по строчкам, сохранение изменений, добавление новых, удаление данных в DBGrid).
При запуске программы открывается форма Меню. В ней находится две кнопки:
1)	Выход из приложения
2)	Электронный каталог для библиотеки
Кнопка “Выход из приложения” позволяет закрыть Меню.
Кнопка “Электронный каталог для библиотеки” создает и открывает Form3, в которой происходит подключение таблице из БД "Электронный каталог для библиотеки", создает и открывает форму Электронный каталог для библиотеки, в которую выводятся данные из БД для пользователя. При создании формы заполняется вычисляемое поле, в котором содержится информации о количестве книг в плохом состоянии.
В открытой форме находятся кнопки:
1)	Отсортировать по названию книги
2)	Отсортировать по году выпуска
3)	Отсортировать по автору
4)	Осуществить выборку по заданному автору
5)	Осуществить выборку по заданному издательству
6)	Показать книги в плохом состоянии
7)	Редактировать
Кнопка “Отсортировать по названию книги” выполняет сортировку А-Я в таблице путем сравнения значений в 1 столбце, считаю с 0.
Кнопка “Отсортировать по году выпуска” выполняет сортировку по возрастанию в таблице путем сравнения значений в 4 столбце, считаю с 0.
Кнопка “Отсортировать по автору” выполняет сортировку А-Я в таблице путем сравнения значений в 2 столбце, считаю с 0.
Кнопка “Осуществить выборку по заданному автору” создает и открывает форму Книги определенного автора. 
Кнопка “Осуществить выборку по заданному издательству” создает и открывает форму Книги определенного издательства. 
Кнопка “Показать книги в плохом состоянии” создает и открывает форму Книги в плохом состоянии.
Кнопка “Редактировать” создает и открывает форму Редактирование таблицы.
Форма Книги определенного автора содержит точно такую таблицу, как в форме Электронный каталог для библиотеки. Программа выводит в эту таблицу все строки из таблицы в форме Электронный каталог для библиотеки, колонка “Автор” которых совпадает с полем в форме Электронный каталог для библиотеки, которое задает автора.
По такому же принципу работает форма Книги определенного издательства.
Форма Книги в плохом состоянии содержит точно такую таблицу, как в форме Электронный каталог для библиотеки. Программа выводит в эту таблицу все строки из таблицы в форме Электронный каталог для библиотеки, колонка “Состояние книги” содержит значение “Плохое”.
Форма Редактировать таблицу содержит 8 полей. Каждое поле – отдельный столбец определенной строки исходной таблицы. Для изменения значений в полях необходимо выполнить переключение на другую строку в DBGrid. Для этого создаются кнопки “Вперед” и “Назад”, при нажатии на которые выполняется нажатие соответственных кнопок в DBNavigator. При переключении изменяется значение, которое содержит номер строки (Recno). Также эта форма содержит кнопки:
1)	Сохранить
2)	Очистить поля
3)	Добавить нового
4)	Удалить
При нажатии кнопки “Сохранить” значения полей присваиваются той строке, на которое указывает соответствующее значение Recno, в таблице в форме Электронный каталог для библиотеки. Также значения этих полей сохраняются в DBGrid, так как при нажатии кнопки “Сохранить” выполняется нажатие соответствующей кнопки в DBNavigator. Происходит пересчет книг в плохом состоянии.
При нажатии кнопки “Очистить поля” значения полей становятся пустыми.
При нажатии кнопки “Добавить нового” значения полей присваиваются новой строке в таблице в форме Электронный каталог для библиотеки. Для добавлений новой строки и присваивания всех значений в DBGrid при нажатии кнопки “Добавить нового” выполняется нажатие соответствующей кнопки в DBNavigator. Происходит пересчет книг в плохом состоянии.
При нажатии кнопки “Удалить” значения полей становятся пустыми. Строка из DBGrid удаляется, так как при нажатии кнопки “Удалить” выполняется нажатие соответствующей кнопки в DBNavigator. Таблица в форме Электронный каталог для библиотеки заполняется заново. Происходит пересчет книг в плохом состоянии.
4. Блок схема 

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/9b7c17da-0e6b-42be-89e1-49273348c485)

При нажатии на кнопку “Электронный каталог для библиотеки”
DBGrid – массив данных в БД (таблица “Электронный каталог для библиотеки”)
StringGrid1 – массив данных в кнопочном приложение в форме Электронный каталог для библиотеки
Edit11 ¬¬¬– поле, в котором содержится информация о том, сколько книг в плохом состоянии

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/02878ab3-59a8-4003-8e88-40895f05f18f)

При нажатии на кнопку “Отсортировать по названию книги”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/65f89f2e-9db4-4ce5-ba72-933efba47964)

При нажатии на кнопку “Отсортировать по году выпуска”


![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/e0029d5c-8715-4223-8624-35e5167915cf)

При нажатии на кнопку “Отсортировать по автору”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/8664a4ab-a334-43c4-89c8-dabb998eb31d)

При нажатии на кнопку “Осуществить выборку по заданному автору”

Edit9 – поле в форме Электронный каталог для библиотеки, в котором задается автор
StringGrid1(4) – таблица в форме Книги определенного автора 
StringGrid1 – таблица в форме Электронный каталог для библиотеки

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/c3abd9ac-5fe7-47c2-adb7-c2a30b7badd1)

При нажатии на кнопку “Осуществить выборку по заданному издательству”

Edit10 – поле в форме Электронный каталог для библиотеки, в котором задается издательство
StringGrid1(5) – таблица в форме Книги определенного издательства 
StringGrid1 – таблица в форме Электронный каталог для библиотеки

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/89d7a683-6bd3-4cdd-b70e-72c655960931)

При нажатии на кнопку “Показать книги в плохом состоянии”

StringGrid1(6) – таблица в форме Книги в плохом состоянии  
StringGrid1 – таблица в форме Электронный каталог для библиотеки

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/05517c3e-2755-42c0-b63d-378e7eb7efa4)

При нажатии на кнопку “Редактировать”

Edit1(7), Edit2(7), Edit3(7), Edit4(7), Edit5(7), Edit6(7), Edit7(7), Edit8(7) – поля в форме Редактирование таблицы, соответствующие столбцам из таблицы в форме Электронный каталог для библиотек
Recno – номер строки в DBGrid

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/97cd0d20-6170-49b0-aa1a-db688dd9868f)

При нажатии на кнопку “Назад”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/27b56bd6-c448-4a8f-b30d-13cd25a3f04f)

При нажатии на кнопку “Вперед”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/4728a4e3-10e4-4730-ac0a-51a724549a6a)

При нажатии на кнопку “Сохранить”

Значение переменной Recno принимает значение при нажатие кнопок “Вперед” и “Назад”, описанных выше, по умолчанию Recno=1

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/c00c8fe4-7780-40cb-b8f4-1e6a4168a6b3)

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/a7bb98d9-5461-4074-aa69-c9d48aa50f3d)

При нажатии на кнопку “Очистить поля”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/582e3217-381c-40cc-b2aa-f7791020aa0a)

При нажатии на кнопку “Добавить нового”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/e813c95c-3e0b-4465-88b4-dcd119909119)


![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/5611ac66-494b-4799-a6d5-d80a22834573)

При нажатии на кнопку “Удалить”

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/b0815865-1ae4-4e95-a47b-e5df80da8cba)

![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/78ad2792-e0be-474b-bf2d-c492b287254f)

5.	Результаты работы программы

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/3e73e4d3-102c-435d-a2b5-ebda2c35c480)
   Рис.1 – Форма меню

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/9c5ab74e-a3ba-4146-b66c-177d662dc226)
   Рис.2 – Отсортированные данные по названию книги

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/909791c5-9f96-458f-9940-722b19b4f61e)
   Рис.3 – Отсортированные данные по году выпуска

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/cdd064aa-8c8d-4814-b1a4-a2b6bce17dfb)
   Рис.3 – Отсортированные данные по автору

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/797d8ee9-cf37-4f92-aff0-5f7b7607e0ba)
   Рис.4 – Выборка книг по автору Иванов Д.В.

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/7a4f4555-f225-4643-a0b0-799def5d91e9)
   Рис.4 – Выборка книг по издательству Red

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/608a01c8-b429-48ff-a0a7-6c63f7f0aa9d)
   Рис.4 – Все книги в плохом состоянии

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/dc48f36a-b13f-49a9-89a1-b3ed91006757)
   Рис.5 – Форма Редактировать таблицу


   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/78becd3f-f124-421d-9654-56b6ce8f4476)
   Рис.6 – Данные без изменения

   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/e32d0031-c614-4040-92da-a74454c9a7d3)
   Рис.7 – Изменено кол-во страниц у 5-ой книге


   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/7c00d21b-2a76-4606-b5eb-031f07bcd042)
   Рис.8 – Очищены все поля


   ![image](https://github.com/Gleb-Dvornikov/-/assets/148574036/6d8ba255-4b14-41d9-b6f2-abccc0dfd85d)
   Рис.8 – Добавлена новая книга test

Все изменения данных автоматически изменяются в БД Microsoft Access.


   





